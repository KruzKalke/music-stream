{% extends "base.html" %}

{% block body_block %}
	
	

    {% if playlist %}
    <h4>{{ playlist.name }}</h4>
    <!-- <audio preload></audio> -->
        <form action="{% url 'playlist' playlist_name_slug=self %}" method = "post" enctype = "multipart/form-data">
            {% csrf_token %}
			<div class="table-responsive">
				<table id="myTable" class="sortable-theme-bootstrap table-hover" data-sortable >
					<thead>
					
								<th data-sorted="false" data-sorted-direction="descending" class="col-md-4" style="font-weight:bold;"> TITLE </th>
								<th data-sorted="false" class="col-xs-1 col-md-1 glyphicon glyphicon-time" style="font-weight:bold;"> </th>
								<th data-sorted="false" class="col-md-3" style="font-weight:bold;"> ALBUM </th>
								<th data-sorted="false" class="col-md-3" style="font-weight:bold;"> ARTIST </th>
								<th data-sorted="false" class="col-md-5" style="font-weight:bold;"> SELECT </th>
						
					</thead>
					{% load filetransfers %}
					{% for song in playlist.songs %}
					{% url "music_stream.views.serve" pk=song.pk as fallback_url %}	
					<tr>
								<td class = "song" data-value="{{song.title}}"> <a href="#" data-src="{% firstof upload.file|public_download_url fallback_url %}" class="song-name">{{ song.title}}</a></td>
								<td id="table-duration{{forloop.counter}}" > 
									<script type="text/javascript"> 
									 var a = "{{song.length}}";
									 var display = document.getElementById("table-duration" + {{forloop.counter}});
									 var duration = Math.floor(a / 60) + ":";
									 if(a % 60 < 10) {
										var sec = "0" + (a % 60);
										duration += sec;
									 }
									 else {
										var sec = a % 60;
										duration += sec;
									 }										 										
									 display.innerHTML = duration;																		
									</script>
								</td>
								<td> <a href="{% url 'album' album_name_slug=song.album_slug %}">{{song.album}}</a></td>
								<td> <a href="{% url 'artist' artist_name_slug=song.artist_slug %}">{{song.artist}}</a></td>
								<td>&nbsp;&nbsp;&nbsp;<input type="checkbox" name ="{{ song.id }}" value = "{{ song.title }}"></td>
					</tr>
					{% endfor %}
				</table>    
			</div>


		</div><br>
		<div class = "btn-group" role = "group" aria-label="...">
		<input class="btn btn-default" type="submit" name="remove" value="Remove Selection from Playlist" />
		<input class="btn btn-default" type="submit" name="delete" value="Delete Playlist" />
		</div>
	</form>
	{% else %}
		<p> Requested Playlist is Empty </p>
    {% endif %}
<table id="Table2"></table>
{% endblock %}